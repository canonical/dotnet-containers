name: dotnet-deps
base: bare
build-base: devel
version: '8.0'
summary: .NET 8 deps rock.
description: |
  .NET is a free, cross-platform, open source developer platform for building
  many different types of applications. This image contains the .NET deps,
  but does not include bash, the .NET SDK nor a package manager.
license: GPL-3.0
platforms:
  amd64:
  arm64:

run-user: _daemon_

environment:
  # Configure web servers to bind to port 8080 when present
  ASPNETCORE_URLS: "http://+:8080"
  # Enable detection of running in a container
  DOTNET_RUNNING_IN_CONTAINER: "true"
  # Set the invariant mode since ICU package isn't included
  # (see https://github.com/dotnet/announcements/issues/20)
  DOTNET_SYSTEM_GLOBALIZATION_INVARIANT: "true"

parts:
  install-deps:
    plugin: nil
    stage-packages:
      - "base-files_base"
      - "base-files_release-info"
      - "ca-certificates_data"
      - "libc6_libs"
      - "libgcc-s1_libs"
      - "libssl3_libs"
      - "libstdc++6_libs"
      - "zlib1g_libs"
    # workaround because /bin in 24.04 is a symlink and that
    # makes pebble and base-files_base have a conflict
    override-build: |
      craftctl default
      rm ${CRAFT_PART_INSTALL}/bin
